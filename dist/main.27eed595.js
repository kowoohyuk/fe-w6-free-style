parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"kv2C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class e{constructor(e){this.target=e,this.selected=null,this.self=null,this.init()}init(){this.initMenu(),this.render(),this.createEvent()}initMenu(){this.menu=[{name:"폴더 생성",fn:()=>this.addFolder()},{name:"파일 생성",fn:()=>this.addFile()},{name:"글자 색상변경",fn:()=>this.updateColor()},{name:"배경 색상변경",fn:()=>this.updateBgColor()},{name:"테두리 색상변경",fn:()=>this.updateBdColor()},{name:"삭제",fn:()=>this.deleteItem()}]}render(){const e=document.createElement("ul");e.classList.add("contextmenu","popup","hidden"),e.insertAdjacentHTML("beforeend",this.menu.reduce((e,t,s)=>e+='<li data-index="'.concat(s,'">').concat(t.name,"</li>"),"")),this.target.append(e),this.self=e}createEvent(){this.self.addEventListener("click",e=>this.handleMenuEvent(e.target.dataset.index))}handleMenuEvent(e){this.menu[e].fn(),this.hideFileContext()}addFolder(){this.selected.addChild("folder")}addFile(){this.selected.addChild("file")}updateColor(){alert("만들고 있어요...")}updateBgColor(){alert("만들고 있어요...")}updateBdColor(){alert("만들고 있어요...")}deleteItem(){this.selected.delete()}openMenu(e,t){this.selected=t,e.stopPropagation(),e.preventDefault(),this.showFileContext(e.pageX-48,e.pageY-120)}showFileContext(e,t){"file"===this.selected.type?(this.self.childNodes[0].classList.add("hidden"),this.self.childNodes[1].classList.add("hidden")):(this.self.childNodes[0].classList.remove("hidden"),this.self.childNodes[1].classList.remove("hidden")),this.self.style.cssText="left: ".concat(e,"px; top: ").concat(t,"px"),this.self.classList.remove("hidden")}hideFileContext(){this.self.classList.add("hidden")}}exports.default=e;
},{}],"imVe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class t{constructor(t){this.target=t,this.init()}init(){this.render()}render(){this.renderTextTag(),this.renderCloseButton(),this.renderModifyButton(),this.renderCompleteButton(),this.renderCancelButton()}renderCloseButton(){const t=document.createElement("button");t.classList.add("button__close"),t.textContent="X",this.target.append(t),t.addEventListener("click",()=>this.hideView())}renderModifyButton(){const t=document.createElement("button");t.classList.add("button__modify"),t.textContent="수정하기",this.target.append(t),this.modifyButton=t,t.addEventListener("click",()=>this.modifyView())}renderCompleteButton(){const t=document.createElement("button");t.classList.add("button__update"),t.classList.add("hidden"),t.textContent="완료",this.target.append(t),this.completeButton=t,t.addEventListener("click",()=>this.updateText())}renderCancelButton(){const t=document.createElement("button");t.classList.add("button__cancel"),t.classList.add("hidden"),t.textContent="취소",this.target.append(t),this.cancelButton=t,t.addEventListener("click",()=>this.removeModifyView())}renderTextTag(){const t=document.createElement("div");this.text=t,this.target.append(t)}openView(t){this.selected=t,this.setText(),this.target.classList.add("active")}setText(){this.text.innerHTML="<h3>".concat(this.selected.name,"</h3><p>").concat(this.selected.content.replace(/\r\n/g,"<br>"),"</p>")}hideView(){this.target.classList.remove("active")}modifyView(){const t=document.createElement("textarea");this.text.lastElementChild.classList.add("hidden"),this.textarea=t,this.target.append(t),t.focus(),t.value=this.selected.content,this.toggleButton()}updateText(){this.selected.content=this.textarea.value.replace(/(?:\r\n|\r|\n)/g,"\r\n"),this.setText(),this.removeModifyView()}removeModifyView(){this.textarea.remove(),this.text.lastElementChild.classList.remove("hidden"),this.toggleButton()}toggleButton(){this.modifyButton.classList.toggle("hidden"),this.cancelButton.classList.toggle("hidden"),this.completeButton.classList.toggle("hidden")}}exports.default=t;
},{}],"HuQZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class t{constructor({_id:t,menu:e,root:i,target:s,view:o,author:n,parent:h=null,type:r,name:a,content:d="",childs:c=[],index:l,color:u="#000",border_color:m="#000",bg_color:v="#fff",canvas:p,rootItem:g}){this._id=t,this.menu=e,this.root=i,this.target=s,this.author=n,this.canvas=p,this.type=r,this.name=a,this.content=d,this.childs=c,this.index=l,this.color=u,this.border_color=m,this.bg_color=v,this.parent=h,this.view=o,this.rootItem=g,this.init()}init(){this.node=document.createElement("div"),this.render(),this.setStyles(),this.setChilds(),this.createEvent(),this.setPosition()}render(){this.node.classList.add("item","item-".concat(this.type)),this.node.insertAdjacentHTML("beforeend",'<input class="item__tag" value="'.concat(this.name,'">')),this.node.insertAdjacentHTML("beforeend",'<div class="item__children"></div>'),this.target.append(this.node)}setStyles(){const t=this.node.firstElementChild;t.style.color=this.color,t.style.borderColor=this.border_color,t.style.backgroundColor=this.bg_color}setPosition(){const t=this.node.firstElementChild.getBoundingClientRect();this.startX=t.x,this.endX=t.x+t.width,this.y=t.y-t.height/2}setChilds(){this.childs.length>0&&(this.childs=this.childs.map(e=>(e.target=this.node.lastElementChild,e.root=this.root,e.view=this.view,e.menu=this.menu,e.canvas=this.canvas,e.parent=this,e.rootItem=this.rootItem,new t(e))))}createEvent(){this.node.addEventListener("contextmenu",t=>this.menu.openMenu(t,this)),this.node.firstElementChild.addEventListener("focusout",t=>this.handleName(t)),"file"===this.type&&this.node.addEventListener("dblclick",()=>this.view.openView(this))}handleName(t){this.name!==t.target.value&&(this.name=t.target.value)}addChild(e){const i={target:this.node.lastElementChild,menu:this.menu,author:this.author,name:"이름 없음",parent:this,view:this.view,canvas:this.canvas,root:this.root,rootItem:this.rootItem,type:e},s=new t(i);this.childs.push(s),this.drawingLine(),s.evFocusNameTag()}evFocusNameTag(){this.node.firstElementChild.focus()}delete(){this.childs.forEach(t=>{t.delete()}),this.parent&&(this.parent.childs=this.parent.childs.filter(t=>t!==this)),this.node.remove(),this.parent.drawingLine()}toObject(){return{_id:this._id,type:this.type,author:this.author,name:this.name,border_color:this.border_color,color:this.color,bg_color:this.bg_color,content:this.content,startX:this.startX,endX:this.endX,y:this.y}}drawingLine(){const t=this.root.getBoundingClientRect(),e=this.canvas;e.width=t.width,e.height=t.height;const i=this.updatePosition();if(!i)return;const s=e.getContext("2d");s.beginPath();const o=t=>{if(!t)return;const{endX:e,y:i}=t;s.moveTo(e-48,i-80),t.childs.forEach(t=>{s.lineTo(t.startX-48,t.y-80),s.moveTo(e-48,i-80)}),t.childs.forEach(t=>{o(t)})};o(i),s.stroke()}updatePosition(){if(!this.parent)return this;const t=e=>null===e.parent?e:t(e.parent),e=t=>{t&&(t.setPosition(),t.childs.forEach(t=>{e(t)}))},i=t(this.parent);return i?(e(i),i):void 0}}exports.default=t;
},{}],"epB2":[function(require,module,exports) {
"use strict";var e=a(require("./src/javascript/contextmenu.js")),t=a(require("./src/javascript/contentview.js")),n=a(require("./src/javascript/item.js"));function a(e){return e&&e.__esModule?e:{default:e}}const o=document.getElementById("itemTarget"),c=document.getElementById("searchInput"),r=document.getElementById("contentview"),l=document.getElementById("saveButton"),s=document.getElementById("shareButton"),i=document.getElementById("titleInput"),d=async()=>{const a=new e.default(o),d=new t.default(r),v=document.querySelector(".canvas"),h=location.pathname.slice(1);let y=null,f=null;if(h.length>0){const e=await fetch("/memotree/".concat(h));console.log(e),f=await e.json()}else{let e=u();e||(e=m()),f=JSON.parse(e)}f.root=o,f.target=o,f.menu=a,f.view=d,f.canvas=v,f.rootItem=f,i.value=f.title,(y=new n.default(f)).drawingLine();const w=e=>{e.closest(".popup")||document.querySelectorAll(".popup").forEach(e=>e.classList.add("hidden"))};c.addEventListener("keyup",({target:e})=>(e=>{if(""===e.value)return;document.querySelectorAll(".item__tag").forEach(t=>{t.value.includes(e.value)?t.classList.add("on-search"):t.classList.remove("on-search")})})(e)),window.addEventListener("click",({target:e})=>w(e)),window.addEventListener("contextmenu",({target:e})=>w(e)),l.addEventListener("click",()=>g(y)),s.addEventListener("click",()=>{delete y._id,g(y),p(u())})},u=()=>localStorage.getItem("memotree"),m=()=>{return localStorage.setItem("memotree",JSON.stringify({_id:null,type:"folder",author:"*",name:"제목 없음",parent:null,status:1})),localStorage.getItem("memotree")},g=e=>{const t=e=>{if(!e)return;const n=e.toObject();return n.childs=e.childs.map(e=>t(e)),n},n=t(e);n.title=i.value,localStorage.setItem("memotree",JSON.stringify(n))},p=async e=>{const t=await fetch("/memotree",{method:"POST",body:e,headers:{Accept:"application/json","Content-Type":"application/json"}}),n=await t.json();alert(n),location.href=location.origin+"/"+n};d();
},{"./src/javascript/contextmenu.js":"kv2C","./src/javascript/contentview.js":"imVe","./src/javascript/item.js":"HuQZ"}]},{},["epB2"], null)
//# sourceMappingURL=/main.27eed595.js.map