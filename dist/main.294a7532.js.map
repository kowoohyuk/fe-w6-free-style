{"version":3,"sources":["src/javascript/contextmenu.js","src/javascript/contentview.js","src/javascript/item.js","main.js"],"names":["Contextmenu","constructor","target","selected","self","init","initMenu","render","createEvent","menu","name","fn","addFolder","addFile","updateColor","updateBgColor","updateBdColor","deleteItem","ul","document","createElement","classList","add","insertAdjacentHTML","reduce","acc","item","index","append","addEventListener","e","handleMenuEvent","dataset","hideFileContext","addChild","alert","delete","openMenu","stopPropagation","preventDefault","showFileContext","pageX","pageY","x","y","type","childNodes","remove","style","cssText","Contentview","renderTextTag","renderCloseButton","renderModifyButton","renderCompleteButton","renderCancelButton","button","textContent","hideView","modifyButton","modifyView","completeButton","updateText","cancelButton","removeModifyView","text","openView","data","setText","innerHTML","content","replace","textarea","lastElementChild","focus","value","toggleButton","toggle","Item","_id","root","view","author","parent","childs","color","border_color","bg_color","canvas","rootItem","node","setStyles","setChilds","setPosition","tag","firstElementChild","borderColor","backgroundColor","thisPosition","getBoundingClientRect","startX","endX","width","height","length","map","v","handleName","push","drawingLine","evFocusNameTag","forEach","filter","toObject","rootRect","rootClass","updatePosition","ctx","getContext","beginPath","dfs","moveTo","lineTo","stroke","getRootClass","itemTarget","getElementById","searchInput","contentview","saveButton","shareButton","titleInput","contextMenu","contentView","querySelector","treeId","location","pathname","slice","rootNode","result","fetch","json","cache","getData","setData","JSON","parse","title","handlePopup","closest","querySelectorAll","includes","searchItem","window","saveData","shareData","localStorage","getItem","setItem","stringify","status","method","body","headers","id","href","origin"],"mappings":"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","file":"main.294a7532.js","sourceRoot":"..","sourcesContent":["export default class Contextmenu {\r\n  constructor(target) {\r\n    this.target = target;\r\n    this.selected = null;\r\n    this.self = null;\r\n    this.init();\r\n  }\r\n  init() {\r\n    this.initMenu();\r\n    this.render();\r\n    this.createEvent();\r\n  }\r\n  initMenu() {\r\n    this.menu = [\r\n      { name : '폴더 생성', fn : () => this.addFolder() },\r\n      { name : '파일 생성', fn : () => this.addFile() },\r\n      { name : '글자 색상변경', fn : () => this.updateColor() },\r\n      { name : '배경 색상변경', fn : () => this.updateBgColor() },\r\n      { name : '테두리 색상변경', fn : () => this.updateBdColor() },\r\n      { name : '삭제', fn : () => this.deleteItem() },\r\n    ];\r\n  }\r\n  render() {\r\n    const ul = document.createElement('ul');\r\n    ul.classList.add('contextmenu', 'popup', 'hidden');\r\n    ul.insertAdjacentHTML('beforeend', this.menu.reduce((acc, item, index) => acc += `<li data-index=\"${index}\">${item.name}</li>`, ''));\r\n    this.target.append(ul);\r\n    this.self = ul;\r\n  }\r\n  createEvent() {\r\n    this.self.addEventListener('click', e => this.handleMenuEvent(e.target.dataset.index));\r\n  }\r\n  handleMenuEvent(index) {\r\n    this.menu[index].fn();\r\n    this.hideFileContext();\r\n  }\r\n  addFolder() {\r\n    this.selected.addChild('folder');\r\n  }\r\n  addFile() {\r\n    this.selected.addChild('file');\r\n  }\r\n  updateColor() {\r\n    alert('만들고 있어요...');\r\n  }\r\n  updateBgColor() {\r\n    alert('만들고 있어요...');\r\n  }\r\n  updateBdColor() {\r\n    alert('만들고 있어요...');\r\n  }\r\n  deleteItem() {\r\n    this.selected.delete();\r\n  }\r\n  openMenu(e, target) {\r\n    this.selected = target;\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    this.showFileContext(e.pageX - 48, e.pageY - 120);\r\n  }\r\n  showFileContext(x, y) {\r\n    if(this.selected.type === 'file') {\r\n      this.self.childNodes[0].classList.add('hidden');\r\n      this.self.childNodes[1].classList.add('hidden');\r\n    } else {\r\n      this.self.childNodes[0].classList.remove('hidden');\r\n      this.self.childNodes[1].classList.remove('hidden');     \r\n    }\r\n    this.self.style.cssText = `left: ${x}px; top: ${y}px`;\r\n    this.self.classList.remove('hidden');\r\n  }\r\n  hideFileContext() {\r\n    this.self.classList.add('hidden');\r\n  }\r\n};","export default class Contentview {\r\n  constructor(target) {\r\n    this.target = target;\r\n    this.init();\r\n  }\r\n  init() {\r\n    this.render();\r\n  }\r\n  render() {\r\n    this.renderTextTag();\r\n    this.renderCloseButton();\r\n    this.renderModifyButton();\r\n    this.renderCompleteButton();\r\n    this.renderCancelButton();\r\n  }\r\n  renderCloseButton() {\r\n    const button = document.createElement('button');\r\n    button.classList.add('button__close');\r\n    button.textContent = 'X';\r\n    this.target.append(button);\r\n    button.addEventListener('click', () => this.hideView());\r\n  }\r\n  renderModifyButton() {\r\n    const button = document.createElement('button');\r\n    button.classList.add('button__modify');\r\n    button.textContent = '수정하기';\r\n    this.target.append(button);\r\n    this.modifyButton = button;\r\n    button.addEventListener('click', () => this.modifyView());\r\n  }\r\n  renderCompleteButton() {\r\n    const completeButton = document.createElement('button');\r\n    completeButton.classList.add('button__update');\r\n    completeButton.classList.add('hidden');\r\n    completeButton.textContent = '완료';\r\n    this.target.append(completeButton);\r\n    this.completeButton = completeButton;\r\n    completeButton.addEventListener('click', () => this.updateText());\r\n  }\r\n  renderCancelButton() {\r\n    const cancelButton = document.createElement('button');\r\n    cancelButton.classList.add('button__cancel');\r\n    cancelButton.classList.add('hidden');\r\n    cancelButton.textContent = '취소';\r\n    this.target.append(cancelButton);\r\n    this.cancelButton = cancelButton;\r\n    cancelButton.addEventListener('click', () => this.removeModifyView());\r\n  }\r\n  renderTextTag() {\r\n    const text = document.createElement('div');\r\n    this.text = text;\r\n    this.target.append(text);\r\n  }\r\n  openView(data) {\r\n    this.selected = data;\r\n    this.setText();\r\n    this.target.classList.add('active');\r\n  }\r\n  setText() {\r\n    this.text.innerHTML = `<h3>${this.selected.name}</h3><p>${this.selected.content.replace(/\\r\\n/g, '<br>')}</p>`;\r\n  }\r\n  hideView() {\r\n    this.target.classList.remove('active');\r\n  }\r\n  modifyView() {\r\n    const textarea = document.createElement('textarea');\r\n    this.text.lastElementChild.classList.add('hidden');\r\n    this.textarea = textarea;\r\n    this.target.append(textarea);\r\n    textarea.focus();\r\n    textarea.value = this.selected.content;\r\n    this.toggleButton();\r\n  }\r\n  updateText() {\r\n    this.selected.content = this.textarea.value.replace(/(?:\\r\\n|\\r|\\n)/g, '\\r\\n');\r\n    this.setText();\r\n    this.removeModifyView();\r\n  }\r\n  removeModifyView() {\r\n    this.textarea.remove();\r\n    this.text.lastElementChild.classList.remove('hidden');\r\n    this.toggleButton();\r\n  }\r\n  toggleButton() {\r\n    this.modifyButton.classList.toggle('hidden');\r\n    this.cancelButton.classList.toggle('hidden');\r\n    this.completeButton.classList.toggle('hidden');\r\n  }\r\n}\r\n\r\n","export default class Item {\r\n  constructor({_id, menu, root, target, view, author, parent = null, type, name, content = '', childs = [], index, color = '#000', border_color = '#000', bg_color = '#fff', canvas, rootItem}) {\r\n    this._id = _id;\r\n    this.menu = menu;\r\n    this.root = root;\r\n    this.target = target;\r\n    this.author = author;\r\n    this.canvas = canvas;\r\n    this.type = type;\r\n    this.name = name;\r\n    this.content = content;\r\n    this.childs = childs;\r\n    this.index = index;\r\n    this.color = color;\r\n    this.border_color = border_color;\r\n    this.bg_color = bg_color;\r\n    this.parent = parent;\r\n    this.view = view;\r\n    this.rootItem = rootItem;\r\n    this.init();\r\n  }\r\n  init() {\r\n    this.node = document.createElement('div');\r\n    this.render();\r\n    this.setStyles();\r\n    this.setChilds();\r\n    this.createEvent();\r\n    this.setPosition();\r\n  }\r\n  render() {\r\n    this.node.classList.add('item', `item-${this.type}`);\r\n    this.node.insertAdjacentHTML('beforeend', `<input class=\"item__tag\" value=\"${this.name}\">`);\r\n    this.node.insertAdjacentHTML('beforeend', `<div class=\"item__children\"></div>`);\r\n    this.target.append(this.node);\r\n  }\r\n  setStyles() {\r\n    const tag = this.node.firstElementChild;\r\n    tag.style.color = this.color;\r\n    tag.style.borderColor = this.border_color;\r\n    tag.style.backgroundColor = this.bg_color;\r\n  }\r\n  setPosition() {\r\n    const thisPosition = this.node.firstElementChild.getBoundingClientRect();\r\n    this.startX = thisPosition.x;\r\n    this.endX = thisPosition.x + thisPosition.width;\r\n    this.y = thisPosition.y - thisPosition.height / 2;\r\n  }\r\n  setChilds() {\r\n    if(this.childs.length > 0) {\r\n      this.childs = this.childs.map(v => {\r\n        v.target = this.node.lastElementChild;\r\n        v.root = this.root;\r\n        v.view = this.view;\r\n        v.menu = this.menu;\r\n        v.canvas = this.canvas;\r\n        v.parent = this;\r\n        v.rootItem = this.rootItem;\r\n        return new Item(v);\r\n      });\r\n    }\r\n  }\r\n  createEvent() {\r\n    this.node.addEventListener('contextmenu', e => this.menu.openMenu(e, this));\r\n    this.node.firstElementChild.addEventListener('focusout', e => this.handleName(e));\r\n    if(this.type === 'file')\r\n      this.node.addEventListener('dblclick', () => this.view.openView(this));\r\n  }\r\n  handleName(e) {\r\n    if(this.name !== e.target.value) {\r\n      this.name = e.target.value;\r\n    }\r\n  }\r\n  addChild(type) {\r\n    const data = {\r\n      target : this.node.lastElementChild,\r\n      menu : this.menu,\r\n      author : this.author,\r\n      name : '이름 없음',\r\n      parent : this,\r\n      view : this.view,\r\n      canvas : this.canvas,\r\n      root : this.root,\r\n      rootItem : this.rootItem,\r\n      type\r\n    }\r\n    const item = new Item(data);\r\n    this.childs.push(item);\r\n    this.drawingLine();\r\n    item.evFocusNameTag();\r\n  }\r\n  evFocusNameTag() {\r\n    this.node.firstElementChild.focus();\r\n  }\r\n  delete() {\r\n    this.childs.forEach(v => {\r\n      v.delete();\r\n    });\r\n    if(this.parent) {\r\n      this.parent.childs = this.parent.childs.filter(v => v !== this);\r\n    }\r\n    this.node.remove();\r\n    this.parent.drawingLine();\r\n  }\r\n  toObject() {\r\n    return {\r\n      _id: this._id,\r\n      type: this.type,\r\n      author: this.author,\r\n      name : this.name,\r\n      border_color : this.border_color,\r\n      color : this.color,\r\n      bg_color : this.bg_color,\r\n      content : this.content,\r\n      startX : this.startX,\r\n      endX : this.endX,\r\n      y : this.y,\r\n    };\r\n  }\r\n  drawingLine() {\r\n    const rootRect = this.root.getBoundingClientRect();\r\n    const canvas = this.canvas;\r\n    canvas.width = rootRect.width;\r\n    canvas.height = rootRect.height;\r\n    const rootClass = this.updatePosition();\r\n    if(!rootClass) return;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.beginPath();\r\n    const dfs = item => {\r\n      if(!item) return;\r\n      const { endX, y } = item;\r\n      ctx.moveTo(endX - 48, y - 80);\r\n      item.childs.forEach(v => {\r\n        ctx.lineTo(v.startX - 48, v.y - 80);\r\n        ctx.moveTo(endX - 48, y - 80);\r\n      });\r\n      item.childs.forEach(v => {\r\n        dfs(v);\r\n      });\r\n    };\r\n    dfs(rootClass);\r\n    ctx.stroke();\r\n  }\r\n  updatePosition() {\r\n    if(!this.parent) return this;\r\n    const getRootClass = item => {\r\n      if(item.parent === null) return item;\r\n      return getRootClass(item.parent);\r\n    };\r\n    const dfs = item => {\r\n      if(!item) return;\r\n      item.setPosition();\r\n      item.childs.forEach(v => {\r\n        dfs(v);\r\n      });\r\n    };\r\n    const rootClass = getRootClass(this.parent);\r\n    if(!rootClass) return;\r\n    dfs(rootClass);\r\n    return rootClass;\r\n  }\r\n}","import Contextmenu from './src/javascript/contextmenu.js';\r\nimport Contentview from './src/javascript/contentview.js';\r\nimport Item from './src/javascript/item.js';\r\n\r\nconst itemTarget = document.getElementById('itemTarget');\r\nconst searchInput = document.getElementById('searchInput');\r\nconst contentview = document.getElementById('contentview');\r\nconst saveButton = document.getElementById('saveButton');\r\nconst shareButton = document.getElementById('shareButton');\r\nconst titleInput = document.getElementById('titleInput');\r\n\r\nconst init = async () => {\r\n  const contextMenu = new Contextmenu(itemTarget);\r\n  const contentView = new Contentview(contentview);\r\n  const canvas = document.querySelector('.canvas');\r\n\r\n  const treeId = location.pathname.slice(1);\r\n  let item = null;\r\n  let rootNode = null;\r\n  if(treeId.length > 0) {\r\n    const result = await fetch(`:8080/memotree/${treeId}`);\r\n    rootNode = await result.json();\r\n  } else {\r\n    let cache = getData();\r\n    if(!cache) cache = setData();\r\n    rootNode = JSON.parse(cache);\r\n  }\r\n  rootNode.root = itemTarget;\r\n  rootNode.target = itemTarget;\r\n  rootNode.menu = contextMenu;\r\n  rootNode.view = contentView;\r\n  rootNode.canvas = canvas;\r\n  rootNode.rootItem = rootNode;\r\n  if(rootNode.title) {\r\n    titleInput.value = rootNode.title;\r\n  }\r\n  item = new Item(rootNode);\r\n  item.drawingLine();\r\n  const handlePopup = target => {\r\n    if(!target.closest('.popup')) {\r\n      document.querySelectorAll('.popup').forEach(v => v.classList.add('hidden'));\r\n    }\r\n  };\r\n\r\n  const searchItem = target => {\r\n    if(target.value === '') return;\r\n    const list = document.querySelectorAll('.item__tag');\r\n    list.forEach(v => {\r\n      if(v.value.includes(target.value)) {\r\n        v.classList.add('on-search');\r\n      } else {\r\n        v.classList.remove('on-search');\r\n      }\r\n    });\r\n  };\r\n  searchInput.addEventListener('keyup', ({ target }) => searchItem(target));\r\n\r\n  window.addEventListener('click', ({ target }) => handlePopup(target));\r\n  window.addEventListener('contextmenu', ({ target }) => handlePopup(target));\r\n  saveButton.addEventListener('click', () => saveData(item));\r\n  shareButton.addEventListener('click', () => {\r\n    delete item._id;\r\n    saveData(item);\r\n    shareData(getData());\r\n  });\r\n};\r\n\r\nconst getData = () => localStorage.getItem('memotree');\r\nconst setData = () => {\r\n  const defaultData = {\r\n    _id: null,\r\n    type: 'folder',\r\n    author: '*',\r\n    name: '제목 없음',\r\n    parent: null,\r\n    status: 1,\r\n  };\r\n  localStorage.setItem('memotree', JSON.stringify(defaultData));\r\n  return localStorage.getItem('memotree');\r\n};\r\nconst saveData = item => {\r\n  const dfs = item => {\r\n    if(!item) return;\r\n    const result = item.toObject();\r\n    result.childs = item.childs.map(v => dfs(v));\r\n    return result;\r\n  };\r\n  const result = dfs(item);\r\n  result.title = titleInput.value;\r\n  localStorage.setItem('memotree', JSON.stringify(result));\r\n}\r\nconst shareData = async item => {\r\n  const result = await fetch(':8080/memotree', { \r\n    method: 'POST', \r\n    body: item, \r\n    headers: { 'Accept': 'application/json', 'Content-Type': 'application/json' } \r\n  });\r\n  const id = await result.json();\r\n  alert(id);\r\n  location.href = location.origin + '/' + id;\r\n}\r\n\r\ninit();"]}